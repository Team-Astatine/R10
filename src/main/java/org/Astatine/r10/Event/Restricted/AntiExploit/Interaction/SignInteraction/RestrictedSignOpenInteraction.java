package org.Astatine.r10.Event.Restricted.AntiExploit.Interaction.SignInteraction;

import io.papermc.paper.event.player.PlayerOpenSignEvent;
import net.kyori.adventure.text.Component;
import org.bukkit.Material;
import org.bukkit.block.Sign;
import org.bukkit.block.sign.Side;
import org.bukkit.block.sign.SignSide;
import teamzesa.Event.EventRegister;
import teamzesa.Util.Function.StringComponentExchanger;

public class RestrictedSignOpenInteraction extends StringComponentExchanger implements EventRegister {

    private final PlayerOpenSignEvent event;

    public RestrictedSignOpenInteraction(PlayerOpenSignEvent event) {
        this.event = event;

        init();
        execute();
    }

    @Override
    public void init() {}

    @Override
    public void execute() {
        Sign sign = event.getSign();

        for (Side sideType : new Side[]{Side.FRONT, Side.BACK}) {
            SignSide side = sign.getSide(sideType);
            int totalLength = 0;

            for (Component lineComp : side.lines())
                totalLength += componentExchanger(lineComp).length();

            if (totalLength < 45)
                return;

            sign.getBlock().setType(Material.AIR);
        }
    }
}
