package org.Astatine.r10.Event.Restricted.AntiExploit.Gravity;

import org.bukkit.Material;
import org.bukkit.block.Block;
import org.bukkit.event.block.BlockPistonExtendEvent;
import org.Astatine.r10.Event.EventRegister;

import java.util.List;

public class AntiPistonPushGravityBlockEvent implements EventRegister {
    private List<Block> targetBlockList;
    private final BlockPistonExtendEvent event;

    public AntiPistonPushGravityBlockEvent(BlockPistonExtendEvent event) {
        this.event = event;
        init();
        execute();
    }

    @Override
    public void init() {
        this.targetBlockList = this.event.getBlocks();
    }

    @Override
    public void execute() {
        boolean typeChecker = this.targetBlockList.stream()
                .anyMatch(banningBlockMaterial ->
                    banningBlockMaterial.getType().equals(Material.SAND)    ||
                    banningBlockMaterial.getType().equals(Material.ANVIL)   ||
                    banningBlockMaterial.getType().equals(Material.GRAVEL)
                );

        if (typeChecker)
            this.event.setCancelled(true);
    }
}
